<div class="dialog-overlay" (click)="cancel()">
  <section class="dialog dialog--animated" [class.dialog--closing]="isClosing" (click)="$event.stopPropagation()">
    <button class="close" type="button" (click)="cancel()">
      <img class="icon-close icon-close--desktop" src="/img/icons/close_black.svg" alt="Close" width="13.5"
        height="13.5" />
      <img class="icon-close icon-close--mobile" src="/img/icons/close_white.svg" alt="Close" width="13.5"
        height="13.5" />
    </button>
    <div class="dialog__left">
      <div class="brand">
        <img src="img/logo-white.svg" alt="Join" class="dialog__logo" />
        <div class="title">{{ mode === 'edit' ? 'Edit contact' : 'Add contact' }}</div>
        <div class="subtitle" *ngIf="mode === 'create'">Tasks are better with a team!</div>
        <div class="title-underline"></div>
      </div>
    </div>
    <div class="dialog__right">

      <div class="dialog__content">
        <div class="avatar" [style.background]="(contact?.color || '#d1d1d1')">
          <span class="initials" *ngIf="mode==='edit' && contact">{{ getInitials(contact.name || '') }}</span>
          <img *ngIf="mode==='create'" src="/img/icons/person-dialog.svg" alt="Person">
        </div>

        <form [formGroup]="form" (ngSubmit)="submit()" class="form">
          <label class="field">
            <div class="field-inner">
              <input formControlName="name" placeholder="Name" />
              <img class="field-icon" src="/img/icons/person.svg" alt="Name" />
            </div>
            <small class="error" *ngIf="form.controls.name.touched && form.controls.name.invalid">
              <ng-container *ngIf="form.controls.name.errors as e">
                <span *ngIf="e['required']">Please enter your full name.</span>
                <span *ngIf="e['fullName']">Please enter both first and last name.</span>
              </ng-container>
            </small>
          </label>
          <label>
            <div class="field-inner">
              <input formControlName="email" type="email" placeholder="Email" />
              <img class="field-icon" src="/img/icons/mail.svg" alt="Email" />
            </div>
            <small class="error" *ngIf="form.controls.email.touched && form.controls.email.errors?.['email']">
              Please enter a valid email address.
            </small>
          </label>
          <label>
            <div class="field-inner">
              <input formControlName="phone" inputmode="numeric" pattern="\d*" placeholder="Phone" />
              <img class="field-icon" src="/img/icons/call.svg" alt="Phone" />
            </div>
            <small class="error" *ngIf="form.controls.phone.touched && form.controls.phone.errors">
              Please enter at least 8 digits.
            </small>
          </label>

          <div class="actions" *ngIf="mode==='create'">
            <button type="button" class="btn  btn-secondary btn-secondary-cancel" (click)="cancel()">Cancel</button>
            <button type="submit" class="btn btn-primary" [disabled]="form.invalid || loading">
              Create contact
              <img src="img/icons/check.svg" alt="Check" width="15.49" height="11.22"
                style="margin-left:8px; vertical-align:middle;" />
            </button>
          </div>
          <div class="actions" *ngIf="mode==='edit'">
            <button type="button" class="btn btn-secondary" (click)="remove()">Delete</button>
            <button type="submit" class="btn btn-primary" [disabled]="form.invalid || loading">
              Save
              <img src="img/icons/check.svg" alt="Check" width="15.49" height="11.22"
                style="margin-left:8px; vertical-align:middle;" />
            </button>
          </div>
        </form>
      </div>
    </div>
  </section>
</div>